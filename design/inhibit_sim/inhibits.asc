Version 4
SHEET 1 1584 852
WIRE 528 -960 240 -960
WIRE 240 -928 240 -960
WIRE 528 -896 528 -960
WIRE 64 -800 -192 -800
WIRE 528 -784 528 -816
WIRE 64 -768 64 -800
WIRE 240 -736 240 -848
WIRE 240 -672 240 -736
WIRE 64 -656 64 -688
WIRE 64 -656 -192 -656
WIRE 192 -656 64 -656
WIRE 64 -576 -192 -576
WIRE 64 -544 64 -576
WIRE 912 -512 864 -512
WIRE 1120 -512 1072 -512
WIRE 1296 -512 1248 -512
WIRE 1456 -512 1408 -512
WIRE 912 -480 912 -512
WIRE 1120 -480 1120 -512
WIRE 1296 -480 1296 -512
WIRE 1456 -480 1456 -512
WIRE -1040 -448 -1248 -448
WIRE -864 -448 -1040 -448
WIRE 240 -448 240 -576
WIRE 64 -432 64 -464
WIRE 64 -432 -192 -432
WIRE 192 -432 64 -432
WIRE 912 -368 912 -400
WIRE 1120 -368 1120 -400
WIRE 1296 -368 1296 -400
WIRE 1456 -368 1456 -400
WIRE -1040 -352 -1040 -448
WIRE 64 -352 -192 -352
WIRE 64 -320 64 -352
WIRE -160 -272 -272 -272
WIRE -32 -272 -80 -272
WIRE 0 -272 -32 -272
WIRE -864 -256 -864 -448
WIRE -1040 -240 -1040 -272
WIRE -912 -240 -1040 -240
WIRE -32 -240 -32 -272
WIRE 240 -224 240 -352
WIRE 64 -208 64 -224
WIRE 192 -208 64 -208
WIRE -1040 -192 -1040 -240
WIRE 64 -160 64 -208
WIRE -1216 -144 -1248 -144
WIRE -1104 -144 -1136 -144
WIRE -32 -128 -32 -160
WIRE 240 -96 240 -128
WIRE 352 -96 240 -96
WIRE -240 -80 -336 -80
WIRE -208 -80 -240 -80
WIRE -96 -80 -128 -80
WIRE -240 -64 -240 -80
WIRE -1040 -48 -1040 -96
WIRE -864 -48 -864 -160
WIRE -784 -48 -864 -48
WIRE 240 -32 240 -96
WIRE 64 -16 64 -80
WIRE 352 -16 352 -96
WIRE -1040 16 -1248 16
WIRE -864 16 -1040 16
WIRE -32 16 -32 -32
WIRE -240 32 -240 16
WIRE 80 80 -96 80
WIRE 80 96 80 80
WIRE -1040 112 -1040 16
WIRE 240 112 240 48
WIRE 352 112 352 48
WIRE 352 112 240 112
WIRE -144 144 -400 144
WIRE -96 144 -96 80
WIRE -80 144 -96 144
WIRE 16 144 0 144
WIRE 240 144 240 112
WIRE -144 176 -144 144
WIRE -864 208 -864 16
WIRE 240 208 240 144
WIRE -1040 224 -1040 192
WIRE -912 224 -1040 224
WIRE -368 224 -480 224
WIRE -208 224 -288 224
WIRE -1040 272 -1040 224
WIRE -144 288 -144 272
WIRE 80 288 80 192
WIRE 80 288 -144 288
WIRE 192 288 80 288
WIRE -1216 320 -1248 320
WIRE -1104 320 -1136 320
WIRE -144 336 -144 288
WIRE -1040 416 -1040 368
WIRE -864 416 -864 304
WIRE -784 416 -864 416
WIRE -144 480 -144 416
WIRE 240 496 240 304
WIRE -784 592 -864 592
WIRE -864 640 -864 592
WIRE -1120 720 -1216 720
WIRE -1040 720 -1120 720
WIRE -912 720 -960 720
WIRE -1120 736 -1120 720
WIRE -864 768 -864 736
WIRE -1120 832 -1120 816
FLAG 240 496 0
FLAG 240 -736 vbus_inhibit
FLAG -192 -800 vbus_inhibit
FLAG -192 -576 vbus_inhibit
FLAG -192 -352 vbus_inhibit
FLAG -192 -656 sep2
FLAG -192 -432 sep3
FLAG 240 144 vbus_ret
FLAG -272 -272 RBF
FLAG 64 -16 0
FLAG -400 144 vbus_inhibit
FLAG -480 224 sep1
FLAG -144 480 0
FLAG 912 -368 0
FLAG 1120 -368 0
FLAG 1296 -368 0
FLAG 1456 -368 0
FLAG 1072 -512 sep2
FLAG 1248 -512 sep3
FLAG 1408 -512 RBF
FLAG 864 -512 sep1
FLAG 864 -704 vbus_inhibit
FLAG 864 -624 0
FLAG 352 -96 vbus
FLAG -1040 -48 0
FLAG -1248 -144 5vusb
FLAG -784 -48 vchrg
FLAG -1040 416 0
FLAG -784 416 vbus
FLAG -1248 16 vbus_usb
FLAG -1248 -448 vchrg_usb
FLAG -864 768 0
FLAG -784 592 vbus_ret
FLAG -1120 832 0
FLAG -1216 720 5vusb
FLAG -1248 320 RBF
FLAG 1040 -704 vchrg_usb
FLAG 1184 -704 vbus_usb
FLAG 1040 -624 0
FLAG 1184 -624 0
FLAG -32 16 0
FLAG -240 32 0
FLAG -336 -80 5vusb
FLAG 1344 -704 5vusb
FLAG 1344 -624 0
FLAG 528 -784 0
FLAG 240 -960 vchrg
FLAG -96 80 5vusb
SYMBOL nmos 192 208 R0
SYMATTR InstName M1
SYMATTR Value IRFH3702
SYMBOL res 224 -48 R0
SYMATTR InstName R1
SYMATTR Value 100
SYMBOL pmos 192 -128 M180
SYMATTR InstName M2
SYMATTR Value IRF7404
SYMBOL pmos 192 -352 M180
SYMATTR InstName M3
SYMATTR Value IRF7404
SYMBOL pmos 192 -576 M180
SYMATTR InstName M4
SYMATTR Value IRF7404
SYMBOL res 48 -784 R0
SYMATTR InstName R2
SYMATTR Value 1Meg
SYMBOL res 48 -560 R0
SYMATTR InstName R3
SYMATTR Value 1Meg
SYMBOL pnp 0 -224 M180
SYMATTR InstName Q1
SYMATTR Value 2N3906
SYMBOL res 48 -176 R0
SYMATTR InstName R4
SYMATTR Value 1Meg
SYMBOL res -64 -288 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R5
SYMATTR Value 100k
SYMBOL pnp -208 272 M180
SYMATTR InstName Q2
SYMATTR Value 2N3906
SYMBOL res -160 320 R0
SYMATTR InstName R6
SYMATTR Value 1Meg
SYMBOL res -272 208 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 100k
SYMBOL res 896 -496 R0
SYMATTR InstName R8
SYMATTR Value {sep1_R}
SYMBOL res 1104 -496 R0
SYMATTR InstName R9
SYMATTR Value {sep23_R}
SYMBOL res 1280 -496 R0
SYMATTR InstName R10
SYMATTR Value {sep23_R}
SYMBOL res 1440 -496 R0
SYMATTR InstName R11
SYMATTR Value {RBF_R}
SYMBOL cap 336 -16 R0
SYMATTR InstName C1
SYMATTR Value 100µF
SYMBOL res -1056 -368 R0
SYMATTR InstName R12
SYMATTR Value 10k
SYMBOL pmos -912 -160 M180
SYMATTR InstName M5
SYMATTR Value IRF7404
SYMBOL npn -1104 -192 R0
SYMATTR InstName Q3
SYMATTR Value 2N3904
SYMBOL res -1120 -160 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 10k
SYMBOL res -1056 96 R0
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL pmos -912 304 M180
SYMATTR InstName M6
SYMATTR Value IRF7404
SYMBOL res -1120 304 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R15
SYMATTR Value 10k
SYMBOL nmos -912 640 R0
SYMATTR InstName M7
SYMATTR Value IRFH3702
SYMBOL res -944 704 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R16
SYMATTR Value 1Meg
SYMBOL res -1104 832 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R17
SYMATTR Value 1Meg
SYMBOL pnp -1104 368 M180
SYMATTR InstName Q4
SYMATTR Value 2N3906
SYMBOL voltage 1040 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V2
SYMATTR Value 8.2V
SYMBOL voltage 1184 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value 7.2V
SYMBOL npn -96 -128 R0
SYMATTR InstName Q5
SYMATTR Value 2N3904
SYMBOL res -16 -144 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R18
SYMATTR Value 100k
SYMBOL res -112 -96 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R19
SYMATTR Value 100k
SYMBOL res -224 32 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R20
SYMATTR Value 10k
SYMBOL voltage 1344 -720 R0
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 5V
SYMBOL res 512 -912 R0
SYMATTR InstName R21
SYMATTR Value 50
SYMBOL res 224 -944 R0
SYMATTR InstName R22
SYMATTR Value .1
SYMBOL npn 16 96 R0
SYMATTR InstName Q6
SYMATTR Value 2N3904
SYMBOL res 16 128 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R23
SYMATTR Value 10k
TEXT 256 312 Left 2 ;Not IRF7458exact but this is really just a sim for PMOS preformance
TEXT 256 152 Left 2 ;vbus_ret is GND in the kicad sch
TEXT 272 504 Left 2 ;this is GNDREF in the kicad sch
TEXT -136 -680 Left 2 ;low = on
TEXT -144 -456 Left 2 ;low = on
TEXT -304 -240 Left 2 ;highZ = on
TEXT -464 248 Left 2 ;low = on
TEXT 792 -280 Left 2 !.param sep1_R=1 sep23_R=1 RBF_R=1
TEXT 792 -168 Left 2 !.tran .1s uic
